---
layout:     post
title:      OAuth2.0
subtitle:   概述
date:       2021-07-12
author:     QuanLi
header-img: img/post-bg-kuaidi.jpg
catalog: true
tags:
    - web
---

# OAuth2.0

​	OAuth 是一个行业的标准授权协议，主要**用来授权第三方应用获取有限的权限**。实际上它就是一种授权机制，它的最终目的是**为第三方应用颁发一个有时效性的令牌 Token**，使得第三方应用能够通过该令牌获取相关的资源。

​	OAuth 2.0 比较常用的场景就是**第三方登录**，当你的网站接入了第三方登录的时候一般就是使用的 OAuth 2.0 协议。

### 角色

首先需要介绍的是 OAuth 2.0 协议中的一些角色，整个授权协议的流程都将围绕着这些角色：

- `resource owner`，资源所有者，能够允许访问受保护资源的实体。
- `resource server`，资源服务器，托管受保护资源的服务器。
- `client`，客户端，使用资源所有者的授权代表资源所有者发起对受保护资源的请求的应用程序。如：web网站，移动应用等。
- `authorization server`，授权服务器，能够向客户端颁发令牌。
- `user-agent`，用户代理，帮助资源所有者与客户端沟通的工具，一般为 web 浏览器，移动 APP 等。

### 协议流程

![image-20210712190239686](https://i.loli.net/2021/07/12/HeDqJTrYtspPzFI.png)

上图详细的描述了这四个角色之间的步骤流程：

- Client 请求 Resource Owner 的授权。授权请求可以直接向 Resource Owner 请求，也可以通过 Authorization Server 间接的进行。
- Client 获得授权许可。
- Client 向 Authorization Server 请求访问令牌。
- Authorization Server 验证授权许可，如果有效则颁发访问令牌。
-  Client 通过访问令牌从 Resource Server 请求受保护资源。
-  Resource Server 验证访问令牌，有效则响应请求。

### 授权

**一个客户端想要获得授权，就需要先到服务商那注册你的应用。**一般需要你提供下面这些信息：

- 应用名称
- 应用网站
- 重定向 URI 或回调 URL（redirect_uri）

**重定向 URI 是服务商在用户授权（或拒绝）应用程序之后重定向用户的地址，因此也是用于处理授权代码或访问令牌的应用程序的一部分。**在你注册成功之后，你会从服务商那获取到你的应用相关的信息：

- 客户端标识 client_id
- 客户端密钥 client_secret

`client_id` 用来表识客户端（公开），`client_secret` 用来验证客户端身份（保密）。