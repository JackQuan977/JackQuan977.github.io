---
layout:     post
title:      SSL&TLS
subtitle:   概述
date:       2021-03-10
author:     QuanLi
header-img: img/post-bg-kuaidi.jpg
catalog: true
tags:
    - 计算机网络
---

# SSL/TLS

### SSL和TLS什么关系

​	SSL 是洋文 “*Secure Sockets Layer* 的缩写，中文叫做「安全套接层」。SSL 因为应用广泛，已经成为互联网上的事实标准。IETF 就在那年把 SSL 标准化。标准化之后的名称改为 TLS（是 “*Transport Layer Security*” 的缩写），中文叫做 「传输层安全协议」。

​	**所以说这两个实际上是一个东西的不同阶段**

### 为什么使用SSL/TLS？

​	因为不使用SSL/TLS的HTTP有三大风险

- 明文传输，第三方可以获知通信的内容
- 有被篡改风险
- 不验证通信双方身份，可以冒充

### 有了SSL/TLS如何解决上面三个问题？

- **信息采用混合加密**，解决被窃听风险。所谓混合加密就是对称加密和非对称加密组合的方式。非对称加密公钥任意分发而私钥保密，但是**公钥加密需要大量计算速度比较慢**，所以先用非对称加密交换**会话秘钥**，然后后来的通信使用对称加密，只使用一个秘钥运算速度快
- **摘要算法保证数据完整性**，防止数据被篡改，摘要算法为数据生成独一无二的数据指纹，用于校验数据的完整性，解决被篡改风险。
- **数字证书验证身份**，将公钥放入经CA机构认证的数字证书中，只要数字证书是可信的，公钥就是可信的

### SSL/TLS协议基本流程

- 客户端向服务器索要并验证服务器的公钥
- 双方协商产生会话秘钥
- 双方采用会话秘钥进行通信

### SSL/TLS四次握手详细流程



- 第一次握手：*ClientHello*客户端向服务端发起加密通信请求

  - 告诉服务器客户端支持的SSL/TLS版本
  - 客户端产生一个随机数用于后面产生会话秘钥
  - 客户端告诉服务器自己支持的加密方法，比如RSA公钥加密。

  ​	

- 第二次握手： *SeverHello*服务端向客户端做出响应
  - 确认SSL/TLS版本
  - 服务端生成一个随机数用于后面产生会话秘钥
  - 确认双方使用的加密方法
  - 返回服务器的数字证书，数字证书中有公钥
- 第三次握手：取出数字证书中的公钥，然后用它加密报文
  - 产生一个随机数，这个随机数会被公钥加密
  - 通知服务器客户端握手结束
  - 上面第一项的随机数，是整个握手阶段出现的第三个随机数，又称"pre-master key"。有了它以后，客户端和服务器就同时有了三个随机数，接着双方就用事先商定的加密方法，各自生成本次会话所用的同一把"会话密钥"。
- 第四次握手：服务器最后回应
  - 服务器用私钥解密拿到第三个随机数，计算出会话秘钥，用于随后信息加密
  - 服务器握手结束通知，以后都用会话秘钥加密

### 为什么要产生三个随机数

**客户端和服务器加上pre master secret三个随机数一同生成的密钥不容易被猜出**